<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>D&D Virtual Tabletop</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Left Sidebar -->
    <div class="sidebar" id="leftSidebar">
        <div class="sidebar-header">
            <h1>üé≤ D&D VTT</h1>
            <p class="info-text">Virtual Tabletop</p>
        </div>

        <div class="controls">
            <button class="btn btn-primary" onclick="vtt.pasteFromClipboard()">
                üìã Paste Image (Ctrl+V)
            </button>
            <button class="btn" onclick="vtt.clearCanvas()">
                üóëÔ∏è Clear Canvas
            </button>
            <button class="btn" onclick="vtt.saveProject()">
                üíæ Save Project
            </button>
            <button class="btn" onclick="vtt.loadProject()">
                üìÇ Load Project
            </button>
        </div>

        <div class="assets-container">
            <div class="assets-header">üì¶ Assets</div>
            <input type="text" id="assetSearch" class="asset-search" placeholder="üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ assets..." oninput="vtt.filterAssets(this.value)">
            <div id="assetsList"></div>
        </div>
    </div>

    <!-- Right Sidebar -->
    <div class="right-sidebar" id="rightSidebar">
        <div class="layers-header">üé® Layers</div>
        <div class="layers-container" id="layersList"></div>
    </div>

    <!-- Main Container -->
    <div class="container">
        <!-- Canvas Area -->
        <div class="canvas-container" id="canvasContainer">
            <canvas id="mainCanvas"></canvas>
            
            <!-- Canvas Controls -->
            <div class="canvas-controls">
                <button class="canvas-control-btn" onclick="vtt.undoDrawing()" title="Undo Drawing (Ctrl+Z)">
                    ‚Ü∂
                </button>
                <button class="canvas-control-btn" onclick="vtt.zoomIn()" title="Zoom In (Scroll Up)">
                    üîç+
                </button>
                <button class="canvas-control-btn" onclick="vtt.zoomOut()" title="Zoom Out (Scroll Down)">
                    üîç-
                </button>
                <button class="canvas-control-btn" onclick="vtt.resetView()" title="Reset View">
                    üéØ
                </button>
                <button class="canvas-control-btn" id="gridToggle" onclick="vtt.toggleGrid()" title="Toggle Grid">
                    ‚ù§Ô∏è
                </button>
                <div class="zoom-display" id="zoomDisplay">100%</div>
            </div>
        </div>
    </div>

    <!-- Sidebar Toggle Buttons -->
    <button class="sidebar-toggle sidebar-toggle-left" id="leftToggle" onclick="vtt.toggleLeftSidebar()">
        ‚óÄ
    </button>
    <button class="sidebar-toggle sidebar-toggle-right" id="rightToggle" onclick="vtt.toggleRightSidebar()">
        ‚ñ∂
    </button>

    <!-- Mobile Top Controls -->
    <div class="mobile-top-controls">
        <button class="mobile-btn" onclick="vtt.pasteFromClipboard()">üìã Paste</button>
        <button class="mobile-btn" onclick="vtt.clearCanvas()">üóëÔ∏è Clear</button>
        <button class="mobile-btn" onclick="vtt.saveProject()">üíæ Save</button>
        <button class="mobile-btn" onclick="vtt.loadProject()">üìÇ Load</button>
    </div>

    <!-- Bottom Drawing Tools Panel -->
    <div class="bottom-tools-panel" id="bottomToolsPanel">
        <div class="tools-section">
            <div class="tool-buttons-horizontal">
                <button class="tool-btn-bottom active" id="tool-select" onclick="vtt.setTool('select')" title="Select (S)">
                    üëÜ
                </button>
                <button class="tool-btn-bottom" id="tool-pan" onclick="vtt.setTool('pan')" title="Move Canvas">
                    ‚úã
                </button>
                <button class="tool-btn-bottom" id="tool-pen" onclick="vtt.setTool('pen')" title="Pen (D)">
                    ‚úèÔ∏è
                </button>
                <button class="tool-btn-bottom" id="tool-line" onclick="vtt.setTool('line')" title="Line (1)">
                    üìè
                </button>
                <button class="tool-btn-bottom" id="tool-ruler" onclick="vtt.setTool('ruler')" title="Ruler (R)">
                    üìê
                </button>
                <button class="tool-btn-bottom" id="tool-rect" onclick="vtt.setTool('rect')" title="Rectangle (3)">
                    ‚¨ú
                </button>
                <button class="tool-btn-bottom" id="tool-circle" onclick="vtt.setTool('circle')" title="Circle (2)">
                    ‚≠ï
                </button>
                <button class="tool-btn-bottom" id="tool-eraser" onclick="vtt.setTool('eraser')" title="Eraser (E)">
                    üßπ
                </button>
            </div>
        </div>
        
        <div class="tools-settings">
            <div class="setting-group">
                <label>Color</label>
                <input type="color" id="drawColor" value="#ff0000" class="color-input">
            </div>
            <div class="setting-group">
                <label>Size: <span id="brushSizeValue">5</span></label>
                <input type="range" id="brushSize" min="1" max="50" value="5" oninput="vtt.updateBrushSize(this.value)">
            </div>
            <div class="setting-group">
                <label>Opacity: <span id="opacityValue">100%</span></label>
                <input type="range" id="drawOpacity" min="10" max="100" value="100" oninput="vtt.updateOpacity(this.value)">
            </div>
            <button class="clear-draw-btn" onclick="vtt.clearDrawing()">üóëÔ∏è Clear</button>
        </div>
    </div>

    <!-- Context Menu -->
    <div id="contextMenu" class="context-menu">
        <div class="context-menu-item" onclick="vtt.renameSelected()">
            <span>‚úèÔ∏è</span>
            <span>Rename</span>
        </div>
        <div class="context-menu-item" onclick="vtt.duplicateSelected()">
            <span>üìã</span>
            <span>Duplicate</span>
        </div>
        <div class="context-menu-item" onclick="vtt.toggleToken()">
            <span>üé≠</span>
            <span id="tokenText">Set as Token</span>
        </div>
        <div class="context-menu-item" onclick="vtt.showRollDialog()">
            <span>üé≤</span>
            <span>Roll Dice</span>
        </div>
        <div class="context-menu-separator"></div>
        <div class="context-menu-item" onclick="vtt.setDisplayName()">
            <span>üè∑Ô∏è</span>
            <span>Set Display Name</span>
        </div>
        <div class="context-menu-item" onclick="vtt.setHP()">
            <span>‚ù§Ô∏è</span>
            <span>Set HP</span>
        </div>
        <div class="context-menu-item" onclick="vtt.editNote()">
            <span>üìñ</span>
            <span>Edit Note</span>
        </div>
        <div class="context-menu-item" onclick="vtt.toggleLock()">
            <span>üîí</span>
            <span id="lockText">Lock/Unlock</span>
        </div>
        <div class="context-menu-separator"></div>
        <div class="context-menu-item" onclick="vtt.bringToFront()">
            <span>‚¨ÜÔ∏è</span>
            <span>Bring to Front</span>
        </div>
        <div class="context-menu-item" onclick="vtt.sendToBack()">
            <span>‚¨áÔ∏è</span>
            <span>Send to Back</span>
        </div>
        <div class="context-menu-separator"></div>
        <div class="context-menu-item danger" onclick="vtt.deleteSelected()">
            <span>üóëÔ∏è</span>
            <span>Delete Selected</span>
        </div>
    </div>

    <!-- Rename Modal -->
    <div id="renameModal" class="modal">
        <div class="modal-content">
            <h2>‚úèÔ∏è Rename Image</h2>
            <input type="text" id="imageNameInput" placeholder="Enter new name" onkeypress="if(event.key==='Enter') vtt.confirmRename()">
            <div class="modal-buttons">
                <button class="modal-btn modal-btn-primary" onclick="vtt.confirmRename()">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô</button>
                <button class="modal-btn modal-btn-secondary" onclick="vtt.cancelRename()">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
            </div>
        </div>
    </div>

    <!-- Note Editor Modal -->
    <div id="noteModal" class="modal">
        <div class="modal-content note-modal-content">
            <h2>üìñ Edit Note</h2>
            <textarea id="noteTextarea" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° note ‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà...&#10;‡πÄ‡∏ä‡πà‡∏ô: Items in this chest:&#10;- Health Potion x3&#10;- Gold coins x50&#10;- Magic sword"></textarea>
            <div class="note-size-controls">
                <label>‡∏Ç‡∏ô‡∏≤‡∏î Note:</label>
                <div class="size-buttons">
                    <button class="size-btn" onclick="vtt.setNoteSize('small')">‡πÄ‡∏•‡πá‡∏Å</button>
                    <button class="size-btn" onclick="vtt.setNoteSize('medium')">‡∏Å‡∏•‡∏≤‡∏á</button>
                    <button class="size-btn" onclick="vtt.setNoteSize('large')">‡πÉ‡∏´‡∏ç‡πà</button>
                </div>
            </div>
            <div class="modal-buttons">
                <button class="modal-btn modal-btn-primary" onclick="vtt.confirmNote()">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô</button>
                <button class="modal-btn modal-btn-secondary" onclick="vtt.cancelNote()">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
            </div>
        </div>
    </div>

    <!-- Display Name Modal -->
    <div id="displayNameModal" class="modal">
        <div class="modal-content">
            <h2>üè∑Ô∏è Set Display Name</h2>
            <input type="text" id="displayNameInput" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡πÉ‡∏ï‡πâ‡∏£‡∏π‡∏õ (‡∏ß‡πà‡∏≤‡∏á‡πÄ‡∏õ‡∏•‡πà‡∏≤ = ‡πÑ‡∏°‡πà‡πÅ‡∏™‡∏î‡∏á)" onkeypress="if(event.key==='Enter') vtt.confirmDisplayName()">
            <div class="modal-buttons">
                <button class="modal-btn modal-btn-primary" onclick="vtt.confirmDisplayName()">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô</button>
                <button class="modal-btn modal-btn-secondary" onclick="vtt.cancelDisplayName()">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
            </div>
        </div>
    </div>

    <!-- HP Modal -->
    <div id="hpModal" class="modal">
        <div class="modal-content">
            <h2>‚ù§Ô∏è Set HP</h2>
            <div class="hp-inputs">
                <div class="hp-input-group">
                    <label>Current HP</label>
                    <input type="number" id="currentHPInput" min="0" placeholder="0">
                </div>
                <div class="hp-input-group">
                    <label>Max HP</label>
                    <input type="number" id="maxHPInput" min="0" placeholder="0">
                </div>
            </div>
            <p class="info-text">‡∏ñ‡πâ‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏Ñ‡∏π‡πà‡πÄ‡∏õ‡πá‡∏ô 0 ‡∏à‡∏∞‡πÑ‡∏°‡πà‡πÅ‡∏™‡∏î‡∏á HP bar</p>
            <div class="modal-buttons">
                <button class="modal-btn modal-btn-primary" onclick="vtt.confirmHP()">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô</button>
                <button class="modal-btn modal-btn-secondary" onclick="vtt.cancelHP()">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
            </div>
        </div>
    </div>

    <!-- Dice Roll Modal -->
    <div id="rollModal" class="modal">
        <div class="modal-content">
            <h2>üé≤ Roll Dice</h2>
            <div class="roll-input-group">
                <label>Dice Formula (e.g., 1d20+2, 2d6-1, 1d20)</label>
                <input type="text" id="rollFormulaInput" placeholder="1d20+0" value="1d20+0" onkeypress="if(event.key==='Enter') vtt.confirmRoll()">
            </div>
            <p class="info-text">Format: [count]d[sides][+/-][modifier]</p>
            <div class="modal-buttons">
                <button class="modal-btn modal-btn-primary" onclick="vtt.confirmRoll()">üé≤ Roll!</button>
                <button class="modal-btn modal-btn-secondary" onclick="vtt.cancelRoll()">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
